# CBB 752 Final Project Part 2: Text Mining

---
## Instructions

**Text Mining Analysis**: Conduct an extensive literature review and text mining analysis using at least 20 publications retrieved from PubMed on your prioritized genes (include PMIDs). Leverage a Large Language Model (LLM), such as GPT-4 or similar, to systematically extract frequent biological terms, key findings, and gene-disease associations. Identify correlations between specific terms within and across publications. Discuss the implications for disease based on these correlations. Compare your LLMassisted findings with protein function annotations from comprehensive databases such as UniProt or GeneCards. Highlight any consistencies or discrepancies identified in this comparative analysis and discuss their significance.

---
## Results from Part 1

We found the overlapping variants from each list of top variants generated by ANNOVAR and ENSEMBL VEP, and filtered out any non-protein-coding genes. Here is the final list below:

| Gene Symbol | Alternative Name |
|-------------|------------------|
| LARGE1      |                  |
| TAFA5       | FAM19A5          |
| SYN3        |                  |
| TBC1D22A    |                  |
| MYO18B      |                  |
| PACSIN2     |                  |
| SEZ6L       |                  |
| CELSR1      |                  |
| EFCAB6      |                  |
| CECR2       |                  |

we saved the list of genes in `prioritized_genes_from_part1.txt`

---

## Installation

### Prerequisites

- Python 3.6+
- Pip package manager

### Setup

1. Clone the repository:
```
git clone https://github.com/yl2342/cbb752-final-project-part2.git
cd cbb752-final-project-part2
```

2. Create a virtual environment and install the dependencies:
```
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

3. Create a `.env` file in the project directory to store your email and Google Gemini API key:
```
EMAIL=your_email_here
GEMINI_API_KEY=your_api_key_here
```
You can obtain a Gemini API key from [Google AI Studio](https://aistudio.google.com/u/1/apikey).

### Gemini Model
- [Gemini API documentation](https://ai.google.dev/gemini-api/docs)
- Gemini model:
  - Gemini 2.0 flash (Default)
    - model name: `gemini-2.0-flash`
    - Beware of the Free tier rate limit (should be enough for this project, generated prompt from 50 pmc fulltext articles is around 500,000 tokens)
      - RPM (requests per minute): 15
      - TPM (tokens per minute): 1,000,000
      - RPD (requests per day): 1500
    - Run time: ~ 1 minute
    

## Usage

The workflow consists of two main steps:

### 1. Search open access full text articles from PubMed Central
For each prioritized gene, we fetched n (5) full text articles (sort by relevance) from PubMed Central. We parse the full text articles and save them as JSON files in the `pmc_full_texts` directory.

```shell
python pmc_fulltext_fetcher.py -l prioritized_gene_from_part1.txt -n 5
```

This will:
- Search top 5 relevant open access PMC full text articles for each prioritized gene
- Save the results to `pmc_full_texts/<gene>_pmc_fulltext.json`. For each full text article retrieved, it contains the following fields:
  - pmcid
  - title
  - published_date
  - full_text

### 2. Analyze the Retrieved Literature with Gemini AI

Process all collected PMC publications for the prioritized genes to construct a prompt embeed with the part II instruction for Gemini AI to conduct a comprehensive analysis as required

```shell
python llm_mining.py 
# or 
python llm_mining.py -m gemini-2.0-flash
```

This will:
- Load all the PMC full text articles from `pmc_full_texts/`
- Generate a prompt embeed with the part II instruction
- Call the Gemini API to analyze the organized literature
- Save both the prompt and LLM response to files:
  - `prompts/fulltext_analysis_prompt.txt`
  - `llm_responses/part2_fulltext_mining_response.txt`


You can also use the `--check`/`-c` flag to just check the generated prompt and the estimated input tokens first without sending the API request, for sanity check. 

```shell
python llm_mining.py -c # Only generate and save prompt without calling the API (for sanity check)
```

--- 
## Output and results

### JSON Articles File
The PMC full text articles are saved as a JSON file with detailed metadata for each article:
- pmcid
- title
- published_date
- full_text

### Analysis Prompt
The prompt file contains the structured input to the language model, including all article full text and analysis instructions.

### Analysis Response
The response file contains the Gemini-generated analysis based on the generated prompt.

--- 

## File Structure

```
geneinsight/
├── llm_mining.py             # Gemini analysis script
├── pmc_fulltext_fetcher.py   # PMC full text fetcher script
├── .env                      # Environment variables (email and API key)
├── prioritized_genes_from_part1.txt # Prioritized genes from part 1
├── pmc_full_texts/         # Directory for stored PubMed results
│   └── <gene>_pmc_fulltext.json    # JSON files with article data
├── prompts/                  # Directory for generated prompts
│   └── fulltext_analysis_prompt.txt
└── llm_responses/            # Directory for analysis results
    └── part2_fulltext_mining_response.txt
```


---

## Results 
### Systematic Analysis of PMC Open Access Literature for Prioritized Genes

. Overall Summary based on the provided articles
Across the 50 full-text scientific articles concerning 10 different genes, several biological terms, key findings, and gene-disease associations are frequently discussed. The most frequent and important biological terms across these publications include "gene expression", "protein", "cells", "signaling pathway", "mutation", "knockdown", "transfection", "reversal learning", "apoptosis", and "inflammation".

Key findings and gene-disease associations observed across the articles are diverse, reflecting the varied functions of the genes studied. For example, SYN3 is discussed in the context of synthetic promoters in plants under stress, as a signaling enhancer ameliorating retinal ganglion cell degeneration in diabetic retinopathy, and in relation to reversal learning performance. EFCAB6 is associated with disorders of sex development, motile cilia, melanoma, pain responses in sensory neurons, and cardiac hypertrophy. LARGE1 is linked to α-dystroglycan glycosylation and muscular dystrophy, neuroepithelial tumors, non-small-cell lung cancer prognosis, and spinal muscular atrophy. CELSR1 is implicated in neuroprotection after cerebral ischemic injury, G protein signaling, spina bifida, and lymphedema. PACSIN2 is discussed in relation to podocyte architecture in kidney disease, autophagy and drug cytotoxicity in cancer, drug resistance in leukemia, endocytosis in the kidney, and endothelial migration in angiogenesis. CECR2 is explored for its cytotoxic activity in cancer, binding to acetylated proteins, association with neural tube defects, and role in somatic cell reprogramming. SEZ6L is linked to motor functions and neurodegeneration, and complement regulation. MYO18B is associated with proliferation and migration in gastric cancer, skeletal muscle proliferation in rheumatoid arthritis, hepatocellular carcinoma progression, sarcomere structure, and nemaline myopathy. TBC1D22A is related to prognosis in ovarian cancer, interactions with viral proteins, cisplatin resistance in ovarian cancer, and genetic epilepsy. TAFA5 is discussed for its role in proliferation and migration in gastric cancer, its function in the spinal cord and pain relief, its association with pulmonary function, and its potential as a biomarker for metabolic disorders.

Correlations between terms reveal interconnected biological processes. For instance, mutations in genes affecting protein function can impact signaling pathways, leading to cellular dysfunction and disease (e.g., EFCAB6 mutations and DSD, CECR2 mutations and neural tube defects). The regulation of gene expression is a recurring theme, often linked to disease pathogenesis or potential therapeutic interventions (e.g., synthetic promoters to control gene expression, altered MYO18B expression in cancer). Cell proliferation, migration, and apoptosis are frequently discussed in the context of cancer progression and potential targets for therapy (e.g., TAFA5 promoting gastric cancer cell proliferation, MYO18B promoting hepatocellular carcinoma progression, PACSIN2's role in apoptosis and cell migration, CECR2's cytotoxic activity). Signaling pathways, such as Wnt/PKC and PI3K/AKT/mTOR, are highlighted as crucial mediators of cellular processes and disease development (e.g., CELSR1 through Wnt/PKC signaling, MYO18B activating PI3K/AKT/mTOR). The concept of drug resistance is explored in several contexts, including cancer treatment and epilepsy, with some genes potentially serving as biomarkers or targets to overcome resistance (e.g., PACSIN2 and drug cytotoxicity/resistance, TBC1D22A and cisplatin resistance).

The implications for disease based on these correlations suggest that common molecular mechanisms and pathways are involved in seemingly disparate conditions. Understanding the interplay between gene mutations, protein function, signaling pathways, and cellular processes like proliferation and apoptosis is crucial for developing targeted therapies and diagnostic biomarkers. The involvement of some genes in both developmental disorders and adult-onset diseases highlights their fundamental roles in biological processes throughout life. The tissue-specific functions and expression patterns of these genes also underscore the complexity of disease pathogenesis and the need for context-specific investigations. The exploration of potential drug targets and biomarkers across different diseases associated with these genes offers promising avenues for future research and clinical applications.

2. Comparative Analysis with External Databases UniProt
Comparison of the information extracted from the provided articles with protein function annotations and other information retrieved from UniProt reveals both consistencies and discrepancies in the understanding of these genes.

SYN3: UniProt confirms that Synapsin-3 (SYN3) is involved in the regulation of neurotransmitter release and synaptogenesis. This is consistent with the article discussing SYN3's role in behavioral flexibility, which is heavily influenced by neurotransmitter dynamics. The article also mentions its involvement in diabetic retinopathy, which affects neuronal cells in the retina, aligning with UniProt's annotation of its function in the nervous system. UniProt also notes ATP and calcium binding, and localization to synaptic vesicle membranes.
EFCAB6: UniProt indicates that EFCAB6 is an EF-hand calcium-binding domain-containing protein that negatively regulates the androgen receptor and is a microtubule inner protein in cilia axonemes required for motile cilia beating. The articles connect EFCAB6 to disorders of sex development (potentially linked to androgen receptor regulation), motile cilia (directly aligning with UniProt's function), melanoma, pain responses in sensory neurons, and cardiac hypertrophy. The association with melanoma, pain, and cardiac hypertrophy are not directly explained by the primary functions listed in UniProt, suggesting potential broader roles or involvement in pathways not yet fully characterized in UniProt.
LARGE1: UniProt describes LARGE1 as a bifunctional glycosyltransferase crucial for the maturation of alpha-dystroglycan (DAG1) through glycosylation, enabling it to bind to extracellular matrix proteins like laminin. This is consistent with the article linking LARGE1 to alpha-dystroglycan glycosylation and muscular dystrophy (dystroglycanopathy). UniProt also lists its involvement in muscular dystrophy-dystroglycanopathy congenital with impaired intellectual development and lissencephaly, which aligns with the disease associations found in the articles. The articles also discuss its role in various cancers and spinal muscular atrophy, suggesting broader implications beyond its established role in muscular dystrophy.
CELSR1: UniProt identifies CELSR1 as a receptor involved in cell-cell signaling during nervous system formation and planar cell polarity. This aligns well with the articles discussing its role in neuroprotection in cerebral ischemic injury (related to nervous system function) and spina bifida (a neural tube defect related to developmental signaling and planar cell polarity). The article also mentions its involvement in G protein signaling and lymphedema, which are supported by UniProt's broader functional annotations including G protein-coupled receptor activity and roles in development.
PACSIN2: UniProt states that PACSIN2 regulates the morphogenesis and endocytosis of caveolae, plays a role in intracellular vesicle-mediated transport, and is essential for endothelial organization in sprouting angiogenesis and modulating cell junctions. This is consistent with the articles linking PACSIN2 to podocyte architecture (related to cell morphology and cytoskeleton), endocytosis in the kidney, and endothelial migration in angiogenesis. The articles also discuss its role in autophagy and drug cytotoxicity in cancer, suggesting broader involvement in cellular processes beyond membrane trafficking.
CECR2: UniProt describes CECR2 as a chromatin remodeling regulator that is a subunit of ATP-dependent ISWI chromatin remodeling complexes involved in DNA-templated processes like replication, transcription, and repair. It also recognizes and binds acylated histones. This aligns with the articles discussing CECR2's cytotoxic activity in cancer (related to uncontrolled proliferation and DNA processes), binding to acetylated proteins (directly supported by UniProt), and its role in somatic cell reprogramming (involving significant chromatin changes). The association with neural tube defects is also consistent with UniProt's annotation of CECR2's role in neurulation and development.
SEZ6L: UniProt indicates that SEZ6L is a single-pass type I membrane protein that may contribute to specialized endoplasmic reticulum functions in neurons and is a candidate tumor suppressor gene. The articles link SEZ6L to motor functions and neurodegeneration and complement regulation. UniProt's annotation of tissue specificity showing expression exclusively in the brain, predominantly in neurons, supports its role in neurological functions. The articles' findings on motor coordination deficits and complement regulation suggest specific functional aspects not fully detailed in UniProt's main function annotation.
MYO18B: UniProt identifies MYO18B as an unconventional myosin involved in intracellular trafficking and potentially regulating muscle-specific genes in the nucleus. It is also associated with Klippel-Feil syndrome 4, autosomal recessive, with nemaline myopathy. The articles discuss MYO18B's role in proliferation and migration in gastric cancer, skeletal muscle proliferation in rheumatoid arthritis, hepatocellular carcinoma progression, and sarcomere structure, which aligns with its function as a myosin and its involvement in muscle and cellular movement. The association with nemaline myopathy in the articles is directly supported by UniProt's disease annotation.
TBC1D22A: UniProt suggests that TBC1D22A may act as a GTPase-activating protein for Rab family proteins and is involved in protein homodimerization. The articles link TBC1D22A to prognosis in ovarian cancer, interactions with viral proteins, cisplatin resistance in ovarian cancer, and genetic epilepsy. UniProt's annotation of its function as a GTPase-activating protein hints at its involvement in cellular signaling and trafficking, which could indirectly relate to these diverse disease associations, though the specific mechanisms are not fully detailed in UniProt.
TAFA5: UniProt describes TAFA5 as a chemokine-like protein that regulates cell proliferation and migration through activation of G protein-coupled receptors (GPCRs). It is also an adipokine regulating vascular smooth muscle cells. The articles discuss TAFA5's role in proliferation and migration in gastric cancer (consistent with UniProt's function), its function in the spinal cord and pain relief, its association with pulmonary function, and its potential as a biomarker for metabolic disorders. The roles in the spinal cord, pain relief, pulmonary function, and metabolic disorders suggest broader functions or tissue specificities not fully elaborated in UniProt's main function annotation.
Significance of Consistencies and Discrepancies:

The consistencies between the provided articles and UniProt reinforce the known fundamental biological roles of these genes in processes such as neurotransmission (SYN3), protein glycosylation (LARGE1), cell signaling and polarity (CELSR1), membrane trafficking (PACSIN2), chromatin remodeling (CECR2), and muscle function (MYO18B). These agreements validate the findings presented in the research articles and highlight the well-established functions of these proteins.

The discrepancies and the broader disease associations found in the articles compared to the primary functions listed in UniProt are also significant. They suggest that these genes may have more diverse roles or be involved in complex biological networks that extend beyond their currently well-defined functions in databases like UniProt. These discrepancies indicate potential areas for further research to fully elucidate the multifaceted contributions of these genes to human health and disease. The articles provide valuable context on the clinical relevance and disease associations that can inform and expand the annotations in comprehensive databases like UniProt. The involvement of several genes in multiple seemingly unrelated conditions (e.g., EFCAB6, LARGE1, TBC1D22A, TAFA5) underscores the complexity of genetic influences on disease susceptibility and pathogenesis.

In summary, the comparative analysis reveals that while UniProt provides a solid foundation of known protein functions, the provided articles offer valuable insights into the broader biological contexts, disease associations, and potential therapeutic implications of these genes, highlighting areas where our understanding is still evolving.

---